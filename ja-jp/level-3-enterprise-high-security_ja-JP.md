# レベル 3 のエンタープライズ高セキュリティ構成

**適用対象**  

-   Windows 10

レベル 3 は、大規模で高度なセキュリティ組織を持つ組織、または攻撃者によって独自にターゲットとされる特定のユーザーとグループの標準として推奨されるセキュリティ構成です。このような組織は通常、資金が豊富で洗練された敵の標的になっているため、ここで説明する追加の制約と制御がメリットとなります。
レベル 3 の構成には、すべてのレベル 2 およびレベル 1 の構成が含まれ、以下のセキュリティ ポリシー、制御、および組織の動作が追加されます。

## ハードウェア

レベル 3 をターゲットとするデバイスは、レベル 2 およびレベル 1 のすべての機能をサポートし、次のハードウェア機能を追加する必要があります。

- [システム ガード](https://docs.microsoft.com/windows/security/threat-protection/windows-defender-system-guard/system-guard-how-hardware-based-root-of-trust-helps-protect-windows)
- [最新のスタンバイ](https://docs.microsoft.com/windows-hardware/design/device-experiences/modern-standby)

## ポリシー

レベル 3 で適用されるポリシーには、レベル 2 およびレベル 1 で推奨されるすべてのポリシーが含まれ、以下のポリシーを追加して、厳格なセキュリティ構成と制御を実装します。これらはユーザーまたはアプリケーションに重大な影響を与える可能性があり、標的になる組織が直面するリスクに見合ったレベルのセキュリティを適用します。Microsoft は、[リング方法](https://docs.microsoft.com/windows/deployment/update/waas-deployment-rings-windows-10-updates)を使用して、統制のとれたテストと展開をお勧めします。

### コンピューター ポリシー

| 特徴 | ポリシー設定 | ポリシー値 | 説明 |
|----------|-----------------|---------------|--------------|
| コントロール パネル / 個人用設定 | ロック画面のスライド ショーを有効にしない | 有効 | PC 設定でロック画面スライド ショー設定を無効にし、ロック画面でスライド ショーを再生できないようにします。既定では、ユーザーは、コンピューターのロック後に実行されるスライド ショーを有効にできます。この設定を有効にした場合、ユーザーは、PC 設定でスライド ショー設定を修正できなくなり、スライド ショーが開始されることもなくなります。 |
| システム / ログオン | ドメインに参加しているコンピューターのローカル ユーザーを列挙する | 無効 | このポリシー設定は、ドメインに参加しているコンピューターのローカル ユーザーを列挙します。このポリシー設定を有効にした場合、ログオン UI に、ドメインに参加しているコンピューターのすべてのローカル ユーザーが列挙されます。このポリシー設定を無効にした場合、または構成しなかった場合、ログオン UI に、ドメインに参加しているコンピューターのローカル ユーザーは列挙されません。 |
| システム / 電源管理 / スリープ設定 | スリープ時 (バッテリー使用時) にスタンバイ状態 (S1-S3) を許可する | 無効 | このポリシー設定では、コンピューターをスリープ状態にするときに、Windows がスタンバイ状態を使用できるかどうかを管理します。このポリシー設定を有効にした場合、または構成しなかった場合、Windows はスタンバイ状態を使用してコンピューターをスリープ状態にします。このポリシー設定を無効にした場合、スタンバイ状態 (S1-S3) は許可されません。 |
| システム / 電源管理 / スリープ設定 | スリープ時 (プラグ接続時) にスタンバイ状態 (S1-S3) を許可する | 無効 | このポリシー設定では、コンピューターをスリープ状態にするときに、Windows がスタンバイ状態を使用できるかどうかを管理します。このポリシー設定を有効にした場合、または構成しなかった場合、Windows はスタンバイ状態を使用してコンピューターをスリープ状態にします。このポリシー設定を無効にした場合、スタンバイ状態 (S1-S3) は許可されません。 |
| Windows コンポーネント / クラウド コンテンツ | Microsoft の消費者エクスペリエンスをオフにする | 有効 | このポリシー設定では、コンシューマーがデバイスと Microsoft アカウントを最大限に活用するためのエクスペリエンスが無効になります。このポリシー設定を有効にした場合は、個人用に設定された Microsoft からのおすすめ情報と、Microsoft アカウントに関する通知が表示されなくなります。このポリシー設定を無効にした場合または構成しなかった場合は、Microsoft からのおすすめ情報と、Microsoft アカウントに関する通知がユーザーに表示されることがあります。注意:この設定は、Enterprise SKU と Education SKU にのみ適用されます。 |
| Windows コンポーネント / 資格情報ユーザー インターフェイス | 昇格時に管理者アカウントを列挙する | 無効 | このポリシー設定により、ユーザーが実行中のアプリケーションの昇格を試みたときに、管理者アカウントが表示されるかどうかを制御します。既定では、ユーザーが実行中のアプリケーションの昇格を試みたときに、管理者アカウントは表示されません。このポリシー設定を有効にした場合、PC 上のローカル管理者アカウントがすべて表示され、ユーザーがその 1 つを選択して、正しいパスワードを入力できます。このポリシー設定を無効にした場合、ユーザーは、昇格時にユーザー名とパスワードを常に入力するよう要求されます。 |
| Windows コンポーネント / Internet Explorer / インターネット コントロール パネル / 詳細ページ | 拡張保護モードが有効になっている場合、ActiveX コントロールが保護モードで実行されないようにする | 有効 | このポリシー設定を使用すると、拡張保護モードが有効になっている場合に保護モードで ActiveX コントロールを実行できなくなります。拡張保護モードと互換性がない ActiveX コントロールがインストールされ、Web サイトがそのコントロールの読み込みを試行した場合、Internet Explorer によってユーザーに通知が行われ、Web サイトを通常の保護モードで実行するためのオプションが表示されます。本ポリシー設定を使用すると、この通知が無効になり、すべての Web サイトが拡張保護モードで実行されるようになります。 |
| Windows コンポーネント / Internet Explorer / インターネット コントロール パネル / 詳細ページ | 64 ビット版の Windows で拡張保護モードで実行しているときに 64 ビット タブ プロセスをオンにする | 有効 | このポリシー設定では、64 ビット バージョンの Windows の拡張保護モードで実行しているときに Internet Explorer 11 で (セキュリティの向上を目的として) 64 ビット プロセスを使用するか、または (互換性の向上を目的として) 32 ビット プロセスを使用するかを決定します。 |
| Windows コンポーネント / Internet Explorer / インターネット コントロール パネル /詳細ページ | 拡張保護モードをオンにする | 有効 | 拡張保護モードでは、64 ビット バージョンの Windows で 64 ビット プロセスが使用され、悪意のある Web サイトに対する保護が強化されています。Windows 8 以降が実行されているコンピューターでは、拡張保護モードによって、Internet Explorer が読み取り元に設定できる場所もレジストリとファイル システムに制限されています。 |
| Windows コンポーネント / Internet Explorer / インターネット コントロール パネル / セキュリティ ページ | イントラネット サイト:すべてのネットワーク パス (UNC) を含める | 無効 | このポリシー設定は、UNC を表す URL をローカル イントラネット セキュリティ ゾーンにマップするかどうかを制御します。 |
| Windows コンポーネント / Microsoft Edge | パスワード マネージャーの構成 | 無効 | このポリシー設定では、パスワード マネージャーを使用して従業員が自分のパスワードをローカル コンピューター上に保存できるかどうかを指定できます。既定では、パスワード マネージャーが有効になります。この設定を有効にした場合は、パスワード マネージャーを使用して従業員が自分のパスワードをローカル コンピューター上に保存できます。この設定を無効にした場合は、パスワード マネージャーを使用して従業員が自分のパスワードをローカル コンピューター上に保存することはできません。この設定を構成しなかった場合は、パスワード マネージャーを使用して自分のパスワードをローカル コンピューター上に保存するかどうかを従業員が選択できます。 

### ユーザー ポリシー

| 特徴 | ポリシー設定 | ポリシー値 | 説明 |
|----------|-----------------|---------------|--------------|
| Windows コンポーネント / Internet Explorer | フォームのユーザー名とパスワードのオートコンプリート機能をオンにする | 無効 | このオートコンプリート機能は、ユーザーがフォームに入力したユーザー名とパスワードを記憶して、次回の入力時に同じ情報を表示できます。この設定を有効にすると、ユーザーは [フォームのユーザー名およびパスワード] や [パスワードを保存する確認をする] のオプションを変更できません。フォームのユーザー名とパスワードのオートコンプリート機能は有効になります。管理者は、[パスワードを保存する確認をする] オプションを選択するかどうかを決定する必要があります。この設定を無効にすると、ユーザーは [フォームのユーザー名およびパスワード] や [パスワードを保存する確認をする] を変更できません。フォームのユーザー名とパスワードのオートコンプリート機能は無効になります。ユーザーは、パスワードの保存を確認するように選択することもできません。この設定を構成しなかった場合、ユーザーは、[フォームのユーザー名およびパスワード] や [パスワードを保存する確認をする] のオプションを有効にすることができます。このオプションを表示するには、[インターネット オプション] ダイアログ ボックスの [コンテンツ] タブで [設定] ボタンをクリックします。 |

## コントロール

レベル 3 で適用される制御は、複雑なセキュリティ構成と制御を実装します。
これらはユーザーまたはアプリケーションへの影響が大きくなる可能性が高く、
最も標的になる組織が直面するリスクに見合ったレベルのセキュリティを適用します。
Microsoft は、監査モードのあるコントロールには監査/実施方法を使用し、そうでないものには[リング方法](https://docs.microsoft.com/windows/deployment/update/waas-deployment-rings-windows-10-updates)を使用することをお勧めします。

| 機能のセット | 特徴 | 説明 |
|--------------|----------|--------------|
| Exploit Protection | Exploit Protectionを有効にする | Exploit Protection は、攻撃を使用して他のデバイスを拡散および感染させるマルウェアからデバイスを保護するのに役立ちます。これは、個々のアプリ レベルで適用できるいくつかの軽減策で構成されています。 |
| Windows Defender Application Control (WDAC) *または* AppLocker | 次のいずれかの方法で、アプリケーションのホワイトリストを使用するようにデバイスを構成します。<br>[ソフトウェア配布が常に集中化されていない場合の AaronLocker](https://blogs.msdn.microsoft.com/aaron_margosis/2018/10/11/aaronlocker-update-v0-91-and-see-aaronlocker-in-action-on-channel-9/) (管理者書き込み可能領域)<br>*または*<br>すべてのソフトウェアがソフトウェア配布を通じてプッシュされた場合の[管理インストーラー](https://docs.microsoft.com/windows/security/threat-protection/windows-defender-application-control/use-windows-defender-application-control-with-managed-installer)<br>*または*<br>デバイス上のソフトウェアが静的で厳しく制御されている場合の[明示的な制御](https://docs.microsoft.com/windows/security/threat-protection/windows-defender-application-control/create-initial-default-policy) | アプリケーション制御は、最近の脅威の状況から企業を保護するための重要な防衛線であり、従来のウイルス対策ソリューションよりも本質的に優れています。アプリケーション制御は、具体的には、すべてのアプリケーションが既定で信頼できると見なされる従来のアプリケーション信頼モデルから、アプリケーションを実行するために信頼を獲得する必要があるモデルに移行します。アプリケーション制御は、ユーザーが実行できるアプリケーションと System Core (カーネル) で実行されるコードを制限することにより、これらの種類のセキュリティの脅威を軽減するのに役立ちます。WDAC ポリシーは未署名のスクリプトと MSI もブロックし、Windows PowerShell は[制約付き言語モード](https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/)で実行されます。 |

## 行動

レベル 3 で推奨される動作は、最も高度なセキュリティ構成を表しています。
管理者権限の削除は困難ですが、最も標的になる組織が直面するリスクに見合ったレベルのセキュリティを達成することが重要です。

| 機能のセット | 特徴 | 説明 |
|--------------|----------|--------------|
| 管理者権限を削除する | ターゲットを 0 として、ローカル管理者グループからできるだけ多くのユーザを削除します。Microsoft では、管理者権限を役割ごとに削除することをお勧めします。次のような役割はより困難です。<br>- 現在のソフトウェア配布システムを使用してパッケージ化することが難しい高速反復ソフトウェアを頻繁にインストールする開発者<br>- 多くの場合、専門のハードウェア デバイスをインストールして操作する必要がある科学者/医師<br>- 管理が委任されている Web リンクの遅い遠隔地<br>通常、後のプロセスでこれらの役割に対処する方が簡単です。<br>Microsoft は、管理者権限への依存関係を特定し、体系的に対処することをお勧めします。<br>- 管理者権限の正当な使用: クラウドソーシングされた管理者 (ワークフローを完了するために新しいプロセスが必要)<br>- 管理者権限の違法な使用: アプリの互換性の依存関係 (アプリの修正が最善の方法)[Desktop App Assure](https://techcommunity.microsoft.com/t5/Windows-IT-Pro-Blog/What-is-Desktop-App-Assure/ba-p/270232) プログラムは、これらのアプリの問題を支援できる | 非管理者として実行すると、露出が制限されます。管理者である場合、実行するすべてのプログラムはコンピューターに無制限にアクセスできます。悪意のあるコードがこれらのプログラムの 1 つに侵入した場合、無制限のアクセスも取得します。攻撃が管理者権限で実行されると、システムを危険にさらす能力がはるかに大きくなり、検出せずにそれを行う能力がはるかに大きくなります。ネットワーク上の他のユーザーを攻撃する能力は、ユーザー権限のみの場合よりも大きくなります。管理者として実行している場合は、次のことができます。<br>- カーネル モードのルートキットやキーロガーをインストールする<br>- サービスをインストールおよび開始する<br>- IE およびシェル アドインを含む ActiveX コントロールをインストールする<br>- 他のユーザーのデータにアクセスする<br>- 他のユーザーがログオンするたびにコードを実行する (Ctrl-Alt-Del ログオン ダイアログに入力されたパスワードのキャプチャを含む)<br>- OS やその他のプログラム ファイルをトロイの木馬に置き換える<br>- ウイルス対策を無効にする/アンインストールする<br>- イベント ログでそのトラックをカバーする<br>- コンピューターを起動不可能にする |





